<div class="example-extension-settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <div class="flex-container alignitemscenter margin0">
                <b data-i18n="ext_obj_title">StatSuite</b>
                <i id="statBarPopoutButton" class="fa-solid fa-window-restore menu_button margin0"></i>
            </div>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <div id="statsDrawerContent">
                <!-- Model Settings Section -->
                <div class="drawer-section">
                    <h4>Model Settings</h4>
                    <label for="offlineMode" class="checkbox_label"><input type="checkbox" id="offlineMode" />Offline Mode</label>
                    <div id="modelSettings" class="flex-container alignitemscenter">
                        <input type="text" name="modelUrl" id="modelUrl" class="text_pole" style="width: 90%;" placeholder="Enter model URL" value="" />
                        <div id="retryConnection" class="fa-solid fa-rotate" style="padding-left: 5px; cursor: pointer;"></div>
                        <div id="modelStatus" class="online_status">
                            <div class="online_status_indicator_stat_suite"></div>
                            <div class="online_status_text_stat_suite">No connection...</div>
                        </div>
                    </div>
                    <small id="offlineExplanation" class="text-muted" style="display: none;">Offline mode is enabled. Only stats marked as manual will be processed (copied over into the next message).</small>
                </div>

                <div class="drawer-section">
                    <h4>General Settings</h4>
                    <div class="setting-item">
                        <label class="checkbox_label">
                            <input type="checkbox" id="enableAutoRequestStats" checked />
                            <span>Enable automatic stat requests</span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label class="checkbox_label">
                            <input type="checkbox" id="showStats" checked />
                            <span>Expand stats by default</span>
                        </label>
                    </div>
                    <div class="setting-item">
                        <label class="checkbox_label">
                            <input type="checkbox" id="collapseOldStats" checked />
                            <span>Collapse old stats</span>
                        </label>
                    </div>
                </div>

                <!-- Character Management Section -->
                <div class="drawer-section">
                    <h4>Character Management</h4>
                    <div class="flex-container">
                        <label class="checkbox_label">
                            <input type="checkbox" id="autoTrackAuthors" checked />
                            <span>Automatically track message authors</span>
                        </label>
                    </div>
                    <div class="flex-container character-input-container">
                        <input type="text" id="new-character-input" class="text_pole" placeholder="Enter character name">
                        <input type="button" id="add-character-btn" class="menu_button" value="Add" />
                    </div>
                    <div id="tracked-characters-list" class="mt-2">
                        <!-- Characters will be populated here -->
                    </div>
                </div>

                <details>
                    <summary>Stats</summary>
                    <div class="drawer-section">
                        <div id="custom-stats-list" class="mt-2">
                            <!-- Stats table will be populated here -->
                        </div>
                    </div>
                </details>

                <details>
                    <summary>Templates</summary>
                    <div class="drawer-section">
                        <div id="template-container" class="mt-2">
                            <!-- Templates will be populated here -->
                        </div>
                    </div>
                </details>

                <details>
                    <summary>Dev mode</summary>
                    <div class="drawer-section">
                        <h4>Actions</h4>
                        <div class="flex-container flex-column">
                            <input id="exportStats" class="menu_button" type="submit" value="Export stats" />
                            <input id="reload" class="menu_button" type="submit" value="Reload stats" />
                            <input id="clearMetadata" class="menu_button" type="submit" value="Clear metadata" />
                        </div>
                        <div class="flex-container">
                        <label class="checkbox_label">
                            <input type="checkbox" id="anonymizeClipboardExport" checked />
                            <span>Anonymize clipboard export</span>
                        </label>
                    </div>
                    </div>
                </details>
            </div>
        </div>
    </div>
</div>

<style>
.drawer-section {
    margin-bottom: 15px;
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: 5px;
}

.drawer-section h4 {
    margin-top: 0;
    margin-bottom: 10px;
    font-size: 1em;
    color: var(--text-color);
}

.character-input-container {
    gap: 10px;
    margin-bottom: 10px;
}

#new-character-input {
    flex: 1;
}

.tracked-character {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 5px;
    margin: 2px 0;
    border: 1px solid var(--border-color);
    border-radius: 4px;
}

.character-actions {
    display: flex;
    gap: 10px;
}

.remove-character, .remove-custom-stat {
    cursor: pointer;
    opacity: 0.7;
}

.remove-character:hover, .remove-custom-stat:hover {
    opacity: 1;
    color: var(--warning-color);
}

.flex-column {
    flex-direction: column;
    gap: 5px;
}

.mt-2 {
    margin-top: 10px;
}

.checkbox_label {
    display: flex;
    align-items: center;
    gap: 5px;
    margin-bottom: 10px;
}

.menu_button {
    margin: 0;
}

/* Template Settings Styles */
.template-controls {
    display: flex;
    flex-direction: column;
    gap: 10px;
    margin-bottom: 15px;
}

.template-selector-container {
    display: flex;
    align-items: center;
    gap: 10px;
}

.template-selector-container label {
    min-width: 80px;
}

.template-actions {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
}

.template-name-container {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
    padding: 10px;
    border: 1px solid var(--border-color);
    border-radius: 5px;
    background-color: var(--bg-color-alt);
}

.template-name-container label {
    min-width: 120px;
}

.template-editor {
    margin-bottom: 15px;
}

.template-editor label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.template-preview-container {
    margin-top: 15px;
}

.template-preview-container label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
}

.template-preview {
    border: 1px solid var(--border-color);
    border-radius: 5px;
    padding: 10px;
    background-color: var(--bg-color-alt);
    min-height: 100px;
    max-height: 300px;
    overflow-y: auto;
}

.template-preview pre {
    margin: 0;
    white-space: pre-wrap;
    word-wrap: break-word;
    font-family: monospace;
    font-size: 0.9em;
}

.template-preview .error {
    color: var(--warning-color);
    font-weight: bold;
}

.template-preview .text-muted {
    color: var(--text-muted);
    font-style: italic;
}
</style>
